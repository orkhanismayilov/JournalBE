$(document).ready(function(){"use strict";function e(e){a.scrollTop()>e.offset().top&&o.addClass("dark"),a.scroll(function(i){a.scrollTop()>e.offset().top?o.addClass("dark"):o.removeClass("dark")})}function i(){c.toggleClass("is-active"),r.toggleClass("active"),o.toggleClass("menu-opened"),t.toggleClass("menu-opened")}var n=$(window),a=$(document),t=$("body"),s=$("html, body"),o=$("#header");window.addEventListener("beforeunload",function(e){t.hide(),t.hasClass("main-page")&&a.scrollTop(0)});var l=$(".btn-up");l.length>0&&(a.scrollTop()>1e3&&l.css("right","50px"),a.scroll(function(){a.scrollTop()>1e3?l.css("right","50px"):l.css("right","-50px")}),l.click(function(){s.animate({scrollTop:0},1e3)}));var r=$("#main-menu");if(r.length>0){var c=$("#menu-trigger"),d=(o.find(".logo"),r.find(".mm-overlay"));c.click(i);var f=r.find(".mm-list-link.has-submenu"),u=r.find(".mm-submenu-item.active");f.click(function(){var e=$(this),i=e.data("submenu");return"#"+u.prop("id")!==i&&(u.slideUp(300,function(){u.removeClass("active"),u=$(i).slideDown(300,function(){u.addClass("active")})}),e.parent().siblings().removeClass("active"),e.parent().addClass("active")),!1}),d.click(i)}var p=$("#search-trigger-header");p.length>0&&p.click(function(){function e(i){27===i.keyCode&&(s.blur(),a.off("keyup",e))}var i,n=$(this),s=$(".search-input");$(this).parent().addClass("active"),i=setTimeout(function(){s.focus(),clearTimeout(i)},200),t.click(function(e){$(e.originalEvent.target).parents(".search").length<=0&&n.parent().removeClass("active")}),a.on("keyup",e)});var h=$("#featured-slider");if(h.length>0){var g=h.find(".featured-item"),m=0,v=0,w=100,C=0,T=0;g.each(function(){$(this).css("z-index",m),m++});h.find(".slider-page").click(function(){var e=$(this).data("page");if(e>v){for(i=0;i<=e;i++)$(g[i]).addClass("active");v=e}else if(e<v){for(var i=g.length;i>e;i--)$(g[i]).removeClass("active");v=e}}),g.mousedown(function(){b(),$(".search-input").blur()}),g.on({touchstart:function(){b()},touchend:function(){k()}});function b(e){(e=e||window.event).preventDefault(),"touchstart"==e.type?C=e.touches[0].clientX:(C=e.clientX,document.onmouseup=k)}function k(e){e=e||window.event,(T="touchend"==e.type?C-e.changedTouches[0].clientX:C-e.clientX)<-w?v-1>=0&&($(g[v]).removeClass("active"),v--):T>w&&v+1<g.length&&($(g[v+1]).addClass("active"),v++),document.onmouseup=null,document.onmousemove=null}}if($("#main-swiper").length>0)var x=new Swiper("#main-swiper",{direction:"vertical",autoHeight:!0,speed:500,effect:"fade",threshold:40,preventInteractionOnTransition:!0,pagination:{el:".pager",clickable:!0,bulletClass:"pager-item",bulletActiveClass:"active",renderBullet:function(e,i){return e===this.slides.length-1?'<li class="'+i+' long"></li>':'<li class="'+i+'"></li>'}},mousewheel:{releaseOnEdges:!0},fadeEffec:{crossFade:!0},on:{init:function(){$(this.slides[0]).find(".section-item").addClass("active"),$("#featured-link").click(function(e){e.preventDefault();var n=$(this).attr("href"),a=$(".swiper-slide").index($(n)[0]);i(),x.slideTo(a)})},slideChangeTransitionStart:function(){this.realIndex<this.slides.length-1&&(s.animate({scrollTop:0},200),t.addClass("no-scroll"))},slideChangeTransitionEnd:function(){var e=$(this.slides[this.realIndex]);$(this.slides[this.previousIndex]).find(".section-item").removeClass("active"),e.find(".section-item").addClass("active")},reachEnd:function(){t.removeClass("no-scroll"),a.scroll(function(){a.scrollTop()>0?x.mousewheel.disable():x.mousewheel.enable()})}}});var y=$("#login-signup-page");if(y.length>0){var S,M;y.find(".tab-link").click(function(){return S=$(this),M=$(S.attr("href")),E(S,M),!1});var A=window.location.hash;""!=A&&((S=$('[href="'+A+'"]')).hasClass("active")||(M=$(A),E(S,M)),a.scrollTop(0));$("#signup-trigger").click(function(){return S=$('.tab-link[href="#signup"]'),M=$("#signup"),E(S,M),!1});function E(e,i){e.siblings(".tab-link").removeClass("active"),e.addClass("active"),i.siblings(".tab-content").hide().removeClass("active"),i.fadeIn(function(){i.addClass("active")})}}var X=$("#scrolldown-tip");X.length>0&&X.click(function(){var e=$(this).data("target");s.animate({scrollTop:$(e).offset().top},1e3)});var z=$("#category-articles");z.length>0&&e(z);var O=$("#article-page");if(O.length>0){var I=O.find(".article"),H=O.find(".article-wrapper"),j=O.find(".article-excerpt-wrapper"),q=j.find(".article-excerpt").offset().top;e(j);Q=$(".exhibit-wrapper");Q.each(function(){var e=$(this),i=e.find(".exhibit-column");a.scrollTop()>e.offset().top-500&&!e.hasClass("animated")&&(i.each(function(e,i){$(i).find(".exhibit-item").each(function(e,i){setTimeout(function(){$(i).animate({top:0,opacity:1},350*(e+1))})})}),e.addClass("animated")),a.scroll(function(){a.scrollTop()>e.offset().top-500&&!e.hasClass("animated")&&(i.each(function(e,i){$(i).find(".exhibit-item").each(function(e,i){setTimeout(function(){$(i).animate({top:0,opacity:1},350*(e+1))})})}),e.addClass("animated"))})});var D=new ScrollMagic.Controller,L=new TweenMax.to(".overlay.white",1,{opacity:1}),U=new TweenMax.to(".article-heading",1,{opacity:.3}),K=new TweenMax.to(".article-excerpt",1,{opacity:1}),_=new TweenMax.to(".progress-bar",1,{width:"100%"}),B=(new ScrollMagic.Scene({offset:0,duration:q-200,reverse:!0}).setTween(L).addTo(D),new ScrollMagic.Scene({offset:0,duration:q-200,reverse:!0}).setTween(U).addTo(D),new ScrollMagic.Scene({offset:0,duration:q-200,reverse:!0}).setTween(K).addTo(D),new ScrollMagic.Scene({offset:H.offset().top,duration:H.offset().top+H.height()-2e3,reverse:!0}).setTween(_).addTo(D),new ScrollMagic.Scene({triggerElement:".article"}).setClassToggle(".article-header-info","show").addTo(D),I.find(".zoomable"));if(B.length>0){var F=$('<figure class="zoomable-image-figure"></figure>'),J=$('<span class="zoom-icon"><i class="far fa-plus-circle"></i></span>'),G=$('<div id="zoom-modal"></div>'),N=$('<span class="close-zoom-modal"><i class="fal fa-times"></i></span>');B.each(function(){var e=$(this),i=F.clone(),n=J.clone(),a=e.clone();i.append(n),i.append(a),e.before(i),e.remove(),n.click(function(){var e=$(this).next().clone();G.append(N).append(e),t.append(G).addClass("menu-opened"),G.fadeIn(300),N.click(function(){G.fadeOut(300,function(){G.empty().remove()}),e=null,t.removeClass("menu-opened")})})})}var Z=I.find(".our-research");if(Z.length>0){var P=Z.find(".or-trigger");P.click(function(){!function(e,i){P.toggleClass("dark"),e.slideToggle(),i.hasClass("fa-plus")?i.removeClass("fa-plus").addClass("fa-minus"):i.removeClass("fa-minus").addClass("fa-plus")}($(this).next(),$(this).find("i"))})}var Q;(Q=I.find(".exhibit-wrapper")).length>0&&Q.each(function(){var e=$(this).find(".slider-wrapper"),i="#"+$(this).find(".swiper-container").prop("id"),n=$(this).find(".exhibit-item"),a=$(this).find(".close"),t=new Swiper(i,{loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",type:"fraction"},spaceBetween:70,effect:"fade"});n.click(function(){var i=$(this).data("slide");t.slideTo(i),e.css("visibility","visible"),e.animate({opacity:1},300)}),a.click(function(){e.animate({opacity:0},300,function(){e.css("visibility","hidden")})})})}var R=$(".share-item.dropdown .share-link");R.length>0&&R.click(function(){function e(i){var s=$(i.originalEvent.target);s.hasClass("share-link")||0!==s.parents(".share-link").length||(n.toggle(),t.fadeOut(200),a.unbind("click",e))}var i=$(this),n=i.find("i"),t=i.next();n.toggle(),t.fadeToggle(200),a.bind("click",e)});var V=$("#user-page");if(V.length>0){e(V.find(".user-title"));var D=new ScrollMagic.Controller,W=new TweenMax.to(".parallax-container",1,{top:"-500px"});new ScrollMagic.Scene({offset:0,duration:n.height(),reverse:!0}).setTween(W).addTo(D)}var Y=$("#issue-page");if(Y.length>0){var ee,ie,ne,ae=Y.find(".issue-info"),te=Y.find(".current-issue-info"),se=Y.find(".current-issue-articles");n.on("load resize",function(){ee=ae.height(),ie=te.outerHeight(!0),ne=ee-ie,se.outerHeight(ne),"none"==se.css("display")&&se.fadeIn(400)})}if($("#all-issues-page").length>0){var oe=0;window.location.hash&&(oe=window.location.hash.split("-")[1]-1);new Swiper(".issues-list",{initialSlide:oe,pagination:{el:".swiper-pagination",type:"bullets",clickable:!0,renderBullet:function(e,i){return'<span class="'+i+'">'+(e+1)+"</span>"}}}).on("slideChange",function(){window.location.hash="#page-"+(this.realIndex+1)})}var le=$("#signup-form");le.length>0&&le.validate({rules:{email:{required:!0,email:!0},password:{required:!0,minlength:8,maxlength:20},password_confirmation:{required:!0,equalTo:"#password"}},success:"valid",submitHandler:function(){var e=le.attr("action");return grecaptcha.execute("6LcXNtMUAAAAAKzXaM9T4FiJGrOUT7xLXDkaHZ6K",{action:"login"}).then(function(i){$.ajax({url:e,method:"post",dataType:"json",data:{email:le.find('[name="email"]').val(),password:le.find('[name="password"]').val(),passwordConfirmation:le.find('[name="password_confirmation"]').val(),token:i}}).done(function(e){"error"==e.type?Swal.fire({title:"Oops!",html:e.errorMsg,icon:"error"}):"success"==e.type&&(Swal.fire({title:e.successTitle,html:e.successMsg,icon:"success"}),le[0].reset())}).fail(function(){Swal.fire({title:"Oops!",html:response.errorMsg,icon:"error"})}).always(function(){console.log("always")})}),!1}});var re=$("#login-form");re.length>0&&re.validate({rules:{login_email:{required:!0,email:!0},login_password:{required:!0,minlength:8,maxlength:20}},success:"valid",submitHandler:function(){var e=re.attr("action");return grecaptcha.execute("6LcXNtMUAAAAAKzXaM9T4FiJGrOUT7xLXDkaHZ6K",{action:"login"}).then(function(i){$.ajax({url:e,method:postMessage,dataType:"json",data:{email:le.find('[name="email"]'),password:le.find('[name="password"]'),token:i}}).done(function(e){}).fail(function(){}).always(function(){})}),!1}})}),$(window).on("load",function(){if($("#preloader").fadeOut("fast"),$(window).width()>1024){$("#particles").length>0&&particlesJS.load("particles","../assets/js/particles.json")}});